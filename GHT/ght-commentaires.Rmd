---
title: "GHT- commentaires"
author: "JcB"
date: "27/01/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

La Région grand Est (RGE) est composée de 10 départements
```{r, echo=FALSE, warning=FALSE, comment=""}
library(sp)
library(rgdal)
library(maptools)
source("../Carto_utilitaires.R")

load("~/Documents/CARTOGRAPHIE/CartographieR/RCarto/GHT/contour_departements.Rda") # dep
plot(dep)
b <- coordinates(dep) # n° des départements
text(b, names(dep), col = "red") # affiche le n° du dep.
```

La région comporte 5200 communes:
```{r}
# communes et limtes départementales
load("~/Documents/CARTOGRAPHIE/CartographieR/RCarto/GHT/ght.Rda") # ght
plot(ght, axes = TRUE, main = "Communes de la Région Grand Est")
plot(dep, border = "red", lty = 1, lwd = 2, add = T)
```

Les coordonnées sont indiquées en Lambert93 (conformes au JO)


La Région grand Est (RGE) est divisée en 12 groupements Hospitalier de territoire (GHT):

01 - GHT Nord Ardennes  02 - GHT Marne Sud Ardennes 03 - GHT de l'Aube et du Sézannais

04 - GHT 04  05 - GHT Marne Haute-Marne Meuse 06 - GHT Lorraine Nord 

07 - GHT Sud Lorraine 08 - GHT Vosges  09 - GHT Moselle Est

10 - GHT 10  11 - GHT Centre Alsace  12 - GHT Haute Alsace

L'étude démographique utilise le fichier POP1B de l'INSEE qui donne par commune le nombre d'hommes et de femmes par trance de 1 an, de 0 à 100 ans et plus. Le fichier initial a été créé en 2013 puis mis à jour régulièrement. La dernière version date de juillet 2015.

```{r}
load("~/Documents/CARTOGRAPHIE/CartographieR/RCarto/GHT/carte_ght_couleur.Rda")
library(RColorBrewer)
coul <- brewer.pal(n=12, name = "Set3")
plot(ght5, col = coul, axes = TRUE, main = "GHT de la RGE")
b <- coordinates(ght5)
text(b, names(ght5))

```

Plusieurs communes ont 0 habitant depuis la première Guerre mondiale.

```{r}
# ensemble des communes constituant les GHT de la RGE. Liste transmise par E.Lagille
pathGht <- "/Users/jean-claudebartier/Documents/Resural/Stat Resural/RPU_Doc/RPU_Carto-Pop-Alsace/Cartographie/ght_com.csv"
ght2 <- read.csv(pathGht)
a <- add0(ght2$code_com) # ajoute un 0 devant un Finess trop court
ght2$code_com <- a
# La carte fournie par l'ARS est fausse car le GHT2 englobe les communes des départements 21 et 71 qui ne font pas partie de la région grand est. Il faut donc les éliminer:

#merging des fichiers
##Jointure utilisant la méthode match qui ne modifie pas l'ordre des lignes
a <- Attrib.Join(ght2, ght, "code_com", "INSEE_COM")

load("~/Documents/CARTOGRAPHIE/CartographieR/RCarto/GHT/limites_des_ght.Rda") # ght3 = liite des ght
```

Etendue des GHT
================
```{r}
c <- sapply(slot(ght3, "polygons"), slot, "area")
d <- sapply(slot(ght3, "polygons"), slot, "ID")
ght_geo <- rbind(c,d)
ght_geo <- t(ght_geo)
# renommer
colnames(ght_geo) <- c("surface (m2)", "GHT")
# tri par n° ID
 ght_geo[order(as.numeric(ght_geo[,2])),]
#tri par surface
ght_geo[order(as.numeric(ght_geo[,1])),]
```
Le GHT e plus petit est le n°12 (région de Mulhouse)

Le GHT le plus grand est le n°5

Population
==========
