---
title: "Analyse du fichier des communes de france"
author: "jcb"
date: "14 octobre 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Origine: fichier SHP sur le bureau
```{r, message=FALSE}
library(sp)
library(rgdal)
library(maptools)

# Mac book air
#dsn <- "/Users/jcb/Documents/Cartographie/Donnee_IGN/COMMUNE"

# IMac (fichiers 2015)
dsn <- "/Users/jean-claudebartier/Documents/CARTOGRAPHIE/CartographieR/IGN_GEOFLA_2015/Fichier_SHP/COMMUNE"

# carte de France
france <- readOGR(dsn = dsn, layer = "COMMUNE")

# readOGR récupère les infos de projection
france@proj4string
```
CRS arguments:
 +proj=lcc +lat_1=44 +lat_2=49 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80
+units=m +no_defs 

Projection Lambert93 s'étend entre les latitudes 44 et 49. Le point central est situé à la latitude 46.5 et la longitude 3 (Greenwich). En coordonnées planes, l'IGN fixe à ce point central les coodonnées X = 700000 et Y = 6600000 mètres.

```{r}
names(france)
unique(france@data$NOM_REG)

```
[1] "ID_GEOFLA"  "CODE_COM"   "INSEE_COM"  "NOM_COM"    "STATUT"     "X_CHF_LIEU" "Y_CHF_LIEU"
 [8] "X_CENTROID" "Y_CENTROID" "Z_MOYEN"    "SUPERFICIE" "POPULATION" "CODE_CANT"  "CODE_ARR"  
[15] "CODE_DEPT"  "NOM_DEPT"   "CODE_REG"   "NOM_REG" 

Récupération des 3 régions
```{r}
alsace <- france[france@data$NOM_REG == "ALSACE",]
lorraine <- france[france@data$NOM_REG == "LORRAINE",]
champagne <- france[france@data$NOM_REG == "CHAMPAGNE-ARDENNE",]
```
Création des polygones
```{r}
# fonctionne uniquement avec le fichier 2014. En 2015 les 3 régions disparaissent...
# alsace.union <- unionSpatialPolygons(alsace, alsace@data$NOM_REG == "ALSACE")
# lorraine.union <- unionSpatialPolygons(lorraine, lorraine@data$NOM_REG == "LORRAINE")
# champagne.union <- unionSpatialPolygons(champagne, champagne@data$NOM_REG == "CHAMPAGNE-ARDENNE")

RGE <- france[france@data$NOM_REG == "ALSACE-CHAMPAGNE-ARDENNE-LORRAINE", ]
rge.union <- unionSpatialPolygons(RGE, RGE@data$NOM_REG == "ALSACE-CHAMPAGNE-ARDENNE-LORRAINE")
```

Autres découpages
-----------------
```{r}
dep <- unionSpatialPolygons(france, IDs = france@data$CODE_DEPT)
plot(dep)

reg <- unionSpatialPolygons(france, IDs = france@data$NOM_REG)
plot(reg)

Les déprtements de France et la région grand est
plot(dep)
plot(rge.union, col = "red", add = TRUE)

```


Les polygones sont ils recouvrants ?
------------------------------------

```{}
a <- over(alsace.union, lorraine.union)
a
a <- over(alsace.union, champagne.union)
a
```
Pour l'Alsace et la lorraine: oui. La fonction __over__ retourne TRUE.



